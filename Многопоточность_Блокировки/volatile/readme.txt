volatile и баги перестановки при оптимизации JIT. Использование блокировки памяти